<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Better Interviews</title>
    <style>
      {{ template "index.css" }}
    </style>
  </head>
  <body>
    <header>
      <h1>Better Interviews</h1>
      <nav>
        <a href="/auth/logout/">Log Out</a>
      </nav>
    </header>
    
    <h2>My Open Roles</h2>

    {{ $userID := .UserID }}
    {{ if len .Feedback }}
      <div class="table-container nowrap">
        <table>
          <thead>
            <tr>
              <th>
                Team
              </th>
              <th>
                Role
              </th>
              <th>
                Opened By
              </th>
              <th>
                Opened On
              </th>
              <th>
                <!-- Give feedback -->
              </th>
              <th>
                <!-- View Feedback -->
              </th>
              <th>
                <!-- Close Role -->
              </th>
            </tr>
          </thead>
          <tbody>
             {{ range .Feedback }}
              <tr>
                <td>
                  {{ .Team }}
                </td>
                <td>
                  {{ .Role }}
                </td>
                <td>
                  {{ $user := UserEmail .CreatorID }}
                  {{ $user.Email }}
                </td>
                <td>
                  {{ .CreatedAt.Format "January 2 2006" }}
                </td>
                <td>
                  <a href="/feedback/request/{{ .ID }}">Request Feedback</a>
                </td>
                {{ $creatorID := .CreatorID.String }}
                {{ if eq $userID $creatorID }}
                  <td>
                    <a href="/feedback/given/{{ .ID }}">View Feedback</a>
                  </td>
                {{ else }}
                  <td></td>
                {{ end }}
                {{ $creatorID := .CreatorID.String }}
                {{ if eq $userID $creatorID }}
                  <td>
                    <a href="/feedback/close/{{ .ID }}">Close Role</a>
                  </td>
                {{ else }}
                  <td></td>
                {{ end }}
              </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
    {{ end }}

    <p>
      <a href="/feedback/">Open a New Role</a>
    </p>

    <form action="/organization/invite/" method="post">
      <div>
        <h2>Invite</h2>
      </div>
      <div class="form-group">
        <label for="type">Type the email of the person you want to invite.</label>
        <input name="email" type="email" placeholder="person@{{ .Domain }}" required />
        <button type="submit">Invite</button>
      </div>
    </form>

    {{ if gt (len .Users) 1 }}
      <h2>
        Members
      </h2>
      <ul>
        {{ range .Users }}
        <li>
          {{ .Email }}
        </li>
        {{ end }}
      </ul>
    {{ end }}
  </body>
</html>
