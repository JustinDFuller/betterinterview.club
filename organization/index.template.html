<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Better Interviews</title>
    <style>
      {{ template "index.css" }}
    </style>
  </head>
  <body>
    <header>
      <h1>Better Interviews</h1>
      <nav>
        <a href="/organization/invite/">Invite</a>
        <a href="/auth/logout/">Log Out</a>
      </nav>
    </header>


    {{ if len .Requests }}
      <h2>My Feedback Requested</h2>
      <div class="table-container nowrap" style="margin-bottom: 32px;">
        <table>
          <thead>
            <tr>
              <th>
                Candidate
              </th>
              <th>
                Opened On
              </th>
              <th>
                <!-- Give feedback -->
              </th>
            </tr>
          </thead>
          <tbody>
             {{ range .Requests }}
              <tr>
                <td>
                  {{ .CandidateName }}
                </td>
                <td>
                  {{ .CreatedAt.Format "January 2 2006" }}
                </td>
                <td>
                  <a href="/feedback/give/{{ .ID }}">Give Feedback</a>
                </td>
              </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
    {{ end }}

    
    <h2>My Open Roles</h2>

    {{ $userID := .UserID }}
    {{ if len .Feedback }}
      <div class="table-container nowrap">
        <table>
          <thead>
            <tr>
              <th>
                Team
              </th>
              <th>
                Role
              </th>
              <th>
                Opened On
              </th>
              <th>
                <!-- Give feedback -->
              </th>
              <th>
                <!-- View Feedback -->
              </th>
              <th>
                <!-- Close Role -->
              </th>
            </tr>
          </thead>
          <tbody>
             {{ range .Feedback }}
              <tr>
                <td>
                  {{ .Team }}
                </td>
                <td>
                  {{ .Role }}
                </td>
                <td>
                  {{ .CreatedAt.Format "January 2 2006" }}
                </td>
                <td>
                  <a href="/feedback/request/{{ .ID }}">Request Feedback</a>
                </td>
                {{ $creatorID := .CreatorID.String }}
                {{ if eq $userID $creatorID }}
                  <td>
                    <a href="/feedback/given/{{ .ID }}">View Feedback</a>
                  </td>
                {{ else }}
                  <td></td>
                {{ end }}
                {{ $creatorID := .CreatorID.String }}
                {{ if eq $userID $creatorID }}
                  <td>
                    <a href="/feedback/close/{{ .ID }}">Close Role</a>
                  </td>
                {{ else }}
                  <td></td>
                {{ end }}
              </tr>
            {{ end }}
          </tbody>
        </table>
      </div>
      <p>
        <a href="/feedback/">Open a New Role</a>
      </p>
    {{ else }}
    <p>
        You don't have any open roles. Get started by <a href="/feedback/">opening a role</a>.
    </p>
    {{ end }}

    
  </body>
</html>
