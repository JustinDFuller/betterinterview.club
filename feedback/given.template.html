<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Better Interviews | Feedback Given</title>
    <style>
      {{ template "index.css" }}
    </style>
  </head>
  <body>
    <header>
      <h1>Feedback Given</h1>
      <nav>
        <a href="/organization/">My Organization</a>
        <a href="/auth/logout/">Log Out</a>
      </nav>
    </header>

    <h2>{{ .Team }} - {{ .Role }}</h2> 
    <form action="/feedback/give/{{ .ID }}" method="post">
      {{ $email := UserEmail .CreatorID }}
      <p>
        Requested By: {{ $email }}
      </p>
      <p>
        On: {{ .CreatedAt.Format "January 2 2006" }}
      </p>


      {{ $responses := .Responses }}
      {{ if len .Responses }}
        <div class="table-container">
          <table>
            <tbody>
              <tr>
                <th>
                  Submitted By 
                </th>
                {{ range .Responses }}
                  <td>
                    {{ $email := UserEmail .CreatorID }}
                    {{ $email }}
                  </td>
                {{ end }}
              </tr> 
              <tr>
                <th>
                  Submitted On 
                </th>
                {{ range .Responses }}
                  <td>
                    {{ .CreatedAt.Format "January 2 2006" }}
                  </td>
                {{ end }}
              </tr>
                {{ range .Questions }} 
                  <tr>
                    <th>
                      {{ .Text }} 
                    </th> 
                    {{ $questionID := .ID }}
                    {{ range $responses }}
                      {{ range .Answers }}
                        {{ if eq .QuestionID $questionID }}
                          <td>
                            {{ if .Response }}  Yes {{ else }} No {{ end }}
                          </td>
                        {{ end }}
                      {{ end }}
                    {{ end }}
                  </tr>
                {{ end }}
              <tr>
                <th>
                  Do you recommend this candidate for this position?
                </th>
                {{ range .Responses }}
                  <td>
                    {{ if .Recommend }}
                      Yes
                    {{ else }}
                      No
                    {{ end }}
                  </td>
                {{ end }}
              </tr> 

            </tbody>
          </table>
        </div>
      {{ else }}
        <p>
          This role has not received any feedback yet.
        </p>
      {{ end }}
    </form>
  </body>
</html>
